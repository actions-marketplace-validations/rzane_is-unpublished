#!/bin/bash

set -euo pipefail

if [ "$#" -lt 1 ]; then
  echo "Missing argument: tag"
  exit 1
fi

yarn ncc build src/runners/action.ts -t -o .github/dist

git add .github/dist
if git commit -m "Release action $1"; then
  git push origin master
fi

git tag "$@"
git push origin "$@"
